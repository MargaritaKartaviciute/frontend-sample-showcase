# Code Walk-through

1. RealityDataApp.tsx       Lines 16-21 - (Standard) View setup used by all samples and an iModel selector from `useSampleWidget`.
1. RealityDataApp.tsx       Lines 28-37 - (Standard) `<Viewer>` component from itwin-viewer-react to display the iModel.
1. RealityDataWidget.tsx    Lines 16-17 - This sample has two state members - Whether to show reality data (defaults to true), and the level of transparency (defaults to 0).
1. RealityDataWidget.tsx    Lines 20-24 - We want the reality data to be displayed on when the viewer loads. This hook uses the onViewOpen `BeUiEvent` to toggle _on_ the reality model and sets the transparency to _0_. Next, we will look at how those two methods work.
1. RealityDataApi.ts        Lines 40-45 - This method sets the reality model transparency. This is done by getting the current reality model appearance overrides and overriding with the desired transparency.
1. RealityDataApi.ts        Lines 43-43 - First, we get any reality model `FeatureAppearance`s on the viewport by calling `getRealityModelAppearanceOverride`. For this sample, we wish to affect the appearance of *all* reality models. Therefore we use -1 as the index. In practice, there may be several reality models attached to the viewport, in that case the index of the reality model having it's appearance overridden should be used.
1. RealityDataApi.ts        Lines 44-44 - If an existing override was found, `clone` it and set the transparency to the desired value. Otherwise, use `FeatureAppearance.fromJSON` to create a `FeatureAppearance` with `transparency` set to the desired value.
1. RealityDataApi.ts        Lines 14-38 - This method turns on or off the reality model depending on the `showReality` argument.
1. RealityDataApi.ts        Lines 15-18 - First `clone` the display style currently on the `ScreenViewport`. Turn off the background map by setting the `backgroundMap` viewFlag to false. This is not strictly necessary, but for this sample the Metrostation iModel looks much better without the background map.
1. RealityDataApi.ts        Lines 20-27 - Turning on a reality model. This sample uses [`findAvailableUnattachedRealityModels`](https://github.com/imodeljs/imodeljs/blob/master/core/frontend/src/ContextRealityModelState.ts#L132) from the imodeljs-frontend package to get unattached `ContextRealityModelProps`. If any `ContextRealityModelProps` are returned, this sample finds the first and uses `attachRealtyModel` to attach it to the display style. Then set the displayStyle of the viewport to the cloned and edited `style` variable.
1. RealityDataApi.ts        Lines 28-37 - Turning off a reality model. Reality models are typically detached using [`DisplayStyleState.detachRealityModelByNameAndUrl`](https://www.itwinjs.org/reference/imodeljs-frontend/views/displaystylestate/detachrealitymodelbynameandurl/). In this example, the name and URL of the attached reality models are not saved. This was done to simplify the sample. Typically, this information is stored in state when the reality model is turned on (attached). So [`DisplayStyleState.forEachRealityModel`](https://www.itwinjs.org/reference/imodeljs-frontend/views/displaystylestate/foreachrealitymodel/) is used to loop through all attached reality models to collect name and URL in `ContextRealityModelState`. In this example, there will only ever be one reality model attached. Then, `DisplayStyleState.detachRealityModelByNameAndUrl` is called. Finally, set the displayStyle of the viewport to the cloned and edited `style` variable. Next, we will cover the controls that call these two methods.
1. RealityDataWidget.tsx    Lines 84-102 - (Standard) The `UiItemsProvider` that provides the widget for this example.
1. RealityDataWidget.tsx    Lines 72-81 - (Standard) The `React.FunctionComponent` returned by the widget. This example has a toggle for turning on/off and a slider for setting the transparency of the reality data model.
1. RealityDataWidget.tsx    Lines 50-58 - A toggle that sets `showRealityDataState`.
1. RealityDataWidget.tsx    Lines 37-47 - A hook with `showRealityDataState` as a dep. `RealityDataApi.toggleRealityModel` is called, then the transparency is set.
1. RealityDataWidget.tsx    Lines 61-69 - A slider that sets `realityDataTransparencyState`.
1. RealityDataWidget.tsx    Lines 29-34 - A hook with `realityDataTransparencyState` as a dep. `RealityDataApi.setRealityDataTransparency` is called with the current state value of the transparency.
